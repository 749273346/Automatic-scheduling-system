# 智能排班系统 (V2.0) 使用手册

## 1. 系统简介
本系统是一个灵活的智能排班工具，支持动态人员配置、个性化偏好设置、自动排班算法以及可视化的手动调整。适用于需要轮值排班的团队（如医院值班、IT运维值班等）。

## 2. 快速开始

### 启动系统
双击运行目录下的 `run.py` 脚本，或在命令行中执行：
```bash
python run.py
```

## 3. 功能详解

### 3.1 人员管理与设置
在首次使用或需要调整团队人数时：
1. 点击工具栏的 **"系统设置"**。
2. 在 "系统人员配置" 区域，设置人员总数（支持 2-52 人）。
3. 点击 **"重置系统人员"**。
   > **警告**：重置操作将清空所有历史排班记录，请谨慎操作。

### 3.2 个性化偏好设置
每个人员都可以设置自己的排班偏好，算法在自动排班时会尽量满足这些条件：
1. 在 "系统设置" 的人员列表中，点击某个人员的 **"偏好设置"** 按钮。
2. **日期黑名单**：在日历上点击日期，将其标记为红色（不可排班）。
3. **高级设置**：
   - **偏好周期**：选择每周排班或隔周排班。
   - **避免配对**：勾选不希望与之同班的人员（例如 A 和 B 关系不好，或技能重叠不宜同班）。
4. 点击保存生效。

### 3.3 排班操作
系统支持 "手动优先 + 自动补全" 的混合模式。

#### 手动排班（最高优先级）
- 在左侧 "人员列表" 中，按住某个人员的代码（如 A, B）。
- 拖拽至中间的日历格子上释放。
- 手动安排的班次会被视为 "锁定" 状态，自动排班算法不会覆盖它。

#### 一键自动排班
- 点击工具栏的 **"一键自动排班"**。
- 系统将根据以下规则生成排班：
  - 每个人员每周排班数量均衡。
  - 遵守个人偏好（黑名单、配对回避）。
  - **周末特殊规则**：周六和周日固定由相同的两人值班（保证周末连续性）。
- 如果对结果不满意，可以点击 **"清除本周排班"** 后重新生成。

### 3.4 统计与导出
- **统计报表**：点击工具栏的 "统计报表" 查看每个人员的排班计数（平日/周末）。
- **导出 Excel**：点击 "导出 Excel" 将当前排班表保存为 .xlsx 文件，方便打印或分享。

## 4. 常见问题
- **Q: 自动排班提示失败？**
  - A: 请检查约束条件是否过于严格。例如，所有人都在某天不可用，或人数过少无法覆盖排班需求。尝试减少黑名单日期。
- **Q: 如何修改颜色？**
  - A: 在 "系统设置" 中点击人员对应的颜色块即可自定义颜色。

## 5. 技术支持
如遇系统错误，请查看 `run.py` 同级目录下的日志或联系开发人员。
